(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14033,        309]
NotebookOptionsPosition[     13171,        289]
NotebookOutlinePosition[     13609,        306]
CellTagsIndexPosition[     13566,        303]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"R", " ", "=", " ", "1.8"}], "\[IndentingNewLine]", 
 RowBox[{"n2", " ", "=", " ", "1"}], "\[IndentingNewLine]", 
 RowBox[{"\[Omega]", " ", "=", " ", 
  RowBox[{"3.3", " ", "*", " ", 
   RowBox[{"10", "^", "14"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"y0", " ", "=", " ", 
  RowBox[{"-", "0.4"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Alpha]", " ", "=", 
  RowBox[{
   RowBox[{"-", "42"}], " ", "Degree"}]}], "\[IndentingNewLine]", 
 RowBox[{":=", " ", 
  RowBox[{
   RowBox[{
   "-", " ", "\:043e\:0431\:044a\:044f\:0432\:043b\:0435\:043d\:0438\:0435"}],
    " ", "\:0444\:0443\:043d\:043a\:0446\:0438\:0438"}]}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.9063611642123175`*^9, 3.9063611659428854`*^9}, {
  3.9063613826781464`*^9, 3.9063613864103723`*^9}, {3.9063614313832793`*^9, 
  3.906361504972395*^9}, {3.906361612786924*^9, 3.9063617817778873`*^9}, {
  3.9063618654659414`*^9, 3.906361889019528*^9}, {3.906361925545597*^9, 
  3.9063619447220955`*^9}, {3.9063620356952243`*^9, 3.906362129177476*^9}, {
  3.90636216519506*^9, 3.9063621992499065`*^9}, {3.906362231372017*^9, 
  3.906362242482727*^9}, {3.9063623404706717`*^9, 3.906362362346546*^9}, {
  3.90656491123903*^9, 3.906564914192704*^9}, {3.906570787434479*^9, 
  3.906570799034849*^9}, {3.906628151243516*^9, 3.9066281775935545`*^9}, {
  3.9066286933875704`*^9, 3.906628700310875*^9}, {3.9090408631223345`*^9, 
  3.909040876673967*^9}},ExpressionUUID->"aa6bbf64-89e0-4dff-8d2c-\
6a9047caf53b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f1", "[", "y_", "]"}], " ", ":=", " ", 
  RowBox[{"1.4", " ", "+", " ", 
   RowBox[{"0.3", " ", "*", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"0.5", " ", "*", " ", 
      RowBox[{"y", "^", "4"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.9063621521959443`*^9, 3.906362374294321*^9, {3.9065725355370364`*^9, 
   3.9065725396264915`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"92ef0012-dde1-4e65-ac4a-4b47e661eda7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Zf", "[", "y_", "]"}], " ", ":=", " ", 
  RowBox[{"12", "+", 
   RowBox[{"3", " ", "*", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"17.951958020513104", " ", "*", " ", "y"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{3.9063621666519394`*^9, 3.906362376756942*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"3ab0173b-72a8-4896-9606-e3affda42653"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n1", "[", "y_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"f1", "[", "y", "]"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{"1", " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.35", " ", "*", " ", 
          RowBox[{"10", "^", "14"}]}], ")"}], " ", "/", " ", "\[Omega]"}], 
       ")"}], "^", "2"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.9063624544466925`*^9, 3.9063625333626595`*^9}, {
  3.9065655083811445`*^9, 3.9065655092127295`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"5baddf5b-a05d-4c4e-b8d8-2c01606b034a"],

Cell[BoxData[{
 RowBox[{"z", " ", "=", " ", "0"}], "\[IndentingNewLine]", 
 RowBox[{"y", " ", "=", " ", "y0"}], "\[IndentingNewLine]", 
 RowBox[{"dy", " ", "=", " ", 
  RowBox[{"-", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{"S", " ", "=", " ", "0"}], "\[IndentingNewLine]", 
 RowBox[{"length", " ", "=", " ", "0.0001"}], "\[IndentingNewLine]", 
 RowBox[{"sinGamma", " ", "=", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{
    RowBox[{"Pi", "/", "2"}], " ", "-", " ", 
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Alpha]", " ", "]"}], " ", "*", "  ", 
      RowBox[{"n2", " ", "/", " ", 
       RowBox[{"n1", "[", "y", "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nGamma", " ", "=", " ", 
   RowBox[{"n1", "[", "y", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"dotsLightBeam", " ", "=", " ", 
  RowBox[{"{", "}"}]}]}], "Input",
 CellChangeTimes->{{3.906565072499572*^9, 3.9065650987797685`*^9}, {
   3.9065651447146797`*^9, 3.9065651696401124`*^9}, {3.9065652690311527`*^9, 
   3.906565403588103*^9}, {3.906565484243134*^9, 3.9065654867355614`*^9}, {
   3.9065657773267307`*^9, 3.90656580865276*^9}, {3.9065659503289766`*^9, 
   3.906565966518121*^9}, {3.906566103716771*^9, 3.9065661357430224`*^9}, {
   3.906566528374442*^9, 3.9065665294827604`*^9}, {3.906566586641364*^9, 
   3.906566587786172*^9}, {3.9065666355972557`*^9, 3.906566664274121*^9}, {
   3.9065669342521043`*^9, 3.9065669450034122`*^9}, {3.9065671027349873`*^9, 
   3.906567128644335*^9}, {3.9065700928728476`*^9, 3.9065700957499285`*^9}, {
   3.906570674303458*^9, 3.9065706825807543`*^9}, {3.9065708093845067`*^9, 
   3.9065708317226486`*^9}, {3.9065720887002153`*^9, 3.90657210568036*^9}, 
   3.9065722306490173`*^9, {3.9065722866381464`*^9, 3.906572302469861*^9}, {
   3.906572347418602*^9, 3.9065723479061346`*^9}, {3.9065727399963875`*^9, 
   3.9065727459018517`*^9}, {3.906572858836753*^9, 3.9065728668789806`*^9}, 
   3.906572945506741*^9, {3.9066282575185347`*^9, 3.9066282583012977`*^9}, {
   3.906628289594813*^9, 3.9066282964833193`*^9}, {3.906628343890774*^9, 
   3.9066283591783967`*^9}, {3.906628704165324*^9, 3.906628709294421*^9}, {
   3.906629482184992*^9, 3.9066294833490105`*^9}, {3.9066298677966785`*^9, 
   3.9066298680596085`*^9}, {3.906631493572031*^9, 3.906631494294899*^9}, 
   3.9090411427209473`*^9},ExpressionUUID->"dbffb435-333a-4d6a-81b8-\
734b6a311a61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"While", "[", " ", 
   RowBox[{
    RowBox[{"z", " ", "<=", " ", 
     RowBox[{"Zf", "[", "y", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"y", " ", "+=", " ", 
      RowBox[{"length", " ", "*", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{"sinGamma", "^", "2"}]}], "]"}], " ", "*", " ", "dy"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "y", "]"}], " ", ">=", " ", "R"}], ",", " ", 
       RowBox[{"nBeta", " ", "=", " ", "n2"}], ",", " ", 
       RowBox[{"nBeta", " ", "=", " ", 
        RowBox[{"n1", "[", "y", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sinBeta", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"sinGamma", " ", "*", " ", "nGamma"}], ")"}], " ", "/", " ", 
       "nBeta"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sinBeta", " ", ">", " ", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"sinBeta", " ", "=", " ", "sinGamma"}], ";", " ", 
        RowBox[{"dy", " ", "*=", " ", 
         RowBox[{"-", "1"}]}]}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", " ", "+=", " ", "length"}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", " ", "+=", " ", 
      RowBox[{"sinBeta", " ", "*", " ", "length"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sinGamma", " ", "=", " ", "sinBeta"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nGamma", " ", "=", " ", "nBeta"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"dotsLightBeam", ",", " ", 
       RowBox[{"{", 
        RowBox[{"z", ",", " ", "y"}], "}"}]}], "]"}], ";"}]}], "\n", "]"}], 
  " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "S", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"endWaveguide", " ", "=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", " ", "=", " ", 
      RowBox[{"-", "R"}]}], ",", " ", 
     RowBox[{"i", " ", "<", " ", "R"}], ",", " ", 
     RowBox[{"i", " ", "+=", " ", "0.0001"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"endWaveguide", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Zf", "[", "i", "]"}], ",", " ", "i"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"dotsLightBeam", ",", "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "->", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "0.001", "]"}], ",", " ", "Green"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "->", " ", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"GridLines", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<Z\>\"", ",", " ", "\"\<Y\>\""}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"endWaveguide", ",", "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "0.001", "]"}], ",", " ", "Blue"}], "}"}]}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "->", "All"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "\:0413\:0440\:0430\:0444\:0438\:043a", " ", 
    "\:0444\:0443\:043d\:043a\:0446\:0438\:0438", " ", "\:043e\:0442", " ", 
    "x", " ", "\:043f\:043e\:0442\:043e\:043c", " ", "\:043c\:0438\:043d", 
    " ", "\:043f\:043e\:0442\:043e\:043c", " ", "\:043c\:0430\:043a\:0441", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{"1.8", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "14.5"}], "}"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}]}], "]"}]}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"-", "1.8"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "0"}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<Z\>\"", ",", "\"\<Y\>\""}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9063625802273645`*^9, 3.9063625940758886`*^9}, {
   3.9063626579778748`*^9, 3.9063626586783543`*^9}, 3.906362709704204*^9, {
   3.906564879702114*^9, 3.906564884750704*^9}, {3.9065649826095505`*^9, 
   3.906564985035453*^9}, {3.906565034864355*^9, 3.906565047879738*^9}, {
   3.9065651061164017`*^9, 3.906565123506151*^9}, {3.9065651725637994`*^9, 
   3.906565180113929*^9}, {3.9065652207054644`*^9, 3.906565221816637*^9}, {
   3.9065658673006544`*^9, 3.9065659079902587`*^9}, {3.9065659919542*^9, 
   3.906565992954688*^9}, {3.906566139327511*^9, 3.906566162118233*^9}, {
   3.90656659058527*^9, 3.906566618141322*^9}, {3.906566667897958*^9, 
   3.906566730970133*^9}, {3.9065667689920444`*^9, 3.9065668255290256`*^9}, {
   3.9065668626795516`*^9, 3.9065668747445946`*^9}, {3.906566913619989*^9, 
   3.906566992458444*^9}, {3.9065670233825645`*^9, 3.906567141625002*^9}, {
   3.906569773803084*^9, 3.9065697919797983`*^9}, {3.9065698257542334`*^9, 
   3.9065698308450036`*^9}, {3.9065699167552133`*^9, 
   3.9065699505585613`*^9}, {3.9065700731303654`*^9, 3.906570114947687*^9}, {
   3.9065701464903297`*^9, 3.906570291002803*^9}, {3.906570337708624*^9, 
   3.906570538820019*^9}, {3.906570586319085*^9, 3.906570632470329*^9}, {
   3.906571198363332*^9, 3.906571289811445*^9}, {3.9065717534510546`*^9, 
   3.90657175658578*^9}, {3.906572131674274*^9, 3.9065721390107174`*^9}, 
   3.906572336886846*^9, 3.9065724073395233`*^9, {3.9065724554947195`*^9, 
   3.906572463352708*^9}, {3.906572501743759*^9, 3.9065725025736666`*^9}, {
   3.906572570816209*^9, 3.9065725712098675`*^9}, {3.9065726256334085`*^9, 
   3.906572704989627*^9}, {3.9065728217890973`*^9, 3.9065728243874736`*^9}, {
   3.9065730357521095`*^9, 3.906573085778112*^9}, {3.9065731676802034`*^9, 
   3.9065731697845516`*^9}, {3.9065732218636*^9, 3.9065732603577185`*^9}, {
   3.9066284413803396`*^9, 3.9066285117185183`*^9}, {3.9066285647084117`*^9, 
   3.9066286225012894`*^9}, {3.9066299887496557`*^9, 
   3.9066299907936645`*^9}, {3.9066308686887484`*^9, 3.9066308699747677`*^9}, 
   3.906630910040755*^9, {3.9066315159167624`*^9, 3.906631526654169*^9}, 
   3.9066320583694615`*^9, {3.9066323001006236`*^9, 3.9066323089229183`*^9}, {
   3.906638666095112*^9, 3.906638666283684*^9}, {3.9090412946832857`*^9, 
   3.9090413106987762`*^9}},ExpressionUUID->"1adfb8c2-27c9-4362-a58e-\
947f890c0d3a"]
},
WindowSize->{1440., 741.75},
WindowMargins->{{1146, Automatic}, {Automatic, -6}},
Magnification:>1.3 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1a840b18-479e-494f-99a6-681ef008bc0c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1502, 28, 182, "Input",ExpressionUUID->"aa6bbf64-89e0-4dff-8d2c-6a9047caf53b"],
Cell[2063, 50, 459, 11, 56, "Input",ExpressionUUID->"92ef0012-dde1-4e65-ac4a-4b47e661eda7"],
Cell[2525, 63, 377, 8, 56, "Input",ExpressionUUID->"3ab0173b-72a8-4896-9606-e3affda42653"],
Cell[2905, 73, 624, 16, 36, "Input",ExpressionUUID->"5baddf5b-a05d-4c4e-b8d8-2c01606b034a"],
Cell[3532, 91, 2431, 43, 256, "Input",ExpressionUUID->"dbffb435-333a-4d6a-81b8-734b6a311a61"],
Cell[5966, 136, 7201, 151, 1390, "Input",ExpressionUUID->"1adfb8c2-27c9-4362-a58e-947f890c0d3a"]
}
]
*)

