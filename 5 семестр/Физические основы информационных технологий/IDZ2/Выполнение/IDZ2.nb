(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16213,        388]
NotebookOptionsPosition[     15777,        372]
NotebookOutlinePosition[     16257,        390]
CellTagsIndexPosition[     16214,        387]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"conditionExternalElectrode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "2"}], "+", 
     RowBox[{"y", "^", "2"}]}], "<=", "25"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"conditionElectode1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"-", "1.8"}], "+", "x"}], "]"}], "^", "2"}], "+", 
     RowBox[{"0.8", "*", 
      RowBox[{
       RowBox[{"Abs", "[", "y", "]"}], "^", "2"}]}]}], "<=", "0.6"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conditionElectode2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"1.8", "+", "x"}], "]"}], "^", "4"}], "+", 
     RowBox[{"0.5", "*", 
      RowBox[{
       RowBox[{"Abs", "[", "y", "]"}], "^", "4"}]}]}], "<=", "0.8"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "\:043f\:0440\:0435\:0434\:0441\:0442\:0430\:0432\:043b\:044f\:0435\:0442", 
   " ", "\:0441\:043e\:0431\:043e\:0439", " ", 
   "\:043e\:0431\:043b\:0430\:0441\:0442\:044c"}], ",", 
  RowBox[{
   RowBox[{
    RowBox[{
    "\:0432", " ", "\:043a\:043e\:0442\:043e\:0440\:043e\:0439", " ", 
     "\:0443\:0434\:043e\:0432\:043b\:0435\:0442\:0432\:043e\:0440\:044f\:044e\
\:0442", " ", "\:0443\:0441\:043b\:043e\:0432\:0438\:044f\:043c", " ", 
     RowBox[{"cond", ".", "\[IndentingNewLine]", "areaExternalElectrode"}]}], 
    "  ", "=", " ", 
    RowBox[{"ImplicitRegion", "[", 
     RowBox[{"conditionExternalElectrode", ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "y"}], "}"}]}], "]"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"areaElectode1", " ", "=", " ", 
   RowBox[{"ImplicitRegion", "[", 
    RowBox[{"conditionElectode1", " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"areaElectode2", "  ", "=", " ", 
   RowBox[{"ImplicitRegion", "[", 
    RowBox[{"conditionElectode2", " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diffAreaExternalFirst", " ", "=", " ", 
   RowBox[{"RegionDifference", "[", 
    RowBox[{"areaExternalElectrode", ",", " ", "areaElectode1"}], " ", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"fullArea", " ", "=", " ", 
   RowBox[{"RegionDifference", "[", 
    RowBox[{"diffAreaExternalFirst", ",", " ", "areaElectode2"}], " ", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Region", "[", "fullArea", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationExternalElectrode", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "^", "2"}], "+", 
     RowBox[{"y", "^", "2"}]}], " ", "==", " ", "25"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"equationElectode1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"-", "1.8"}], "+", "x"}], "]"}], "^", "2"}], "+", 
     RowBox[{"0.8", "*", 
      RowBox[{
       RowBox[{"Abs", "[", "y", "]"}], "^", "2"}]}]}], " ", "==", " ", 
    "0.6"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equationElectode2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"1.8", "+", "x"}], "]"}], "^", "4"}], "+", 
     RowBox[{"0.5", "*", 
      RowBox[{
       RowBox[{"Abs", "[", "y", "]"}], "^", "4"}]}]}], " ", "==", " ", 
    "0.8"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]External", "  ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]1", "  ", "=", " ", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]2", " ", "=", " ", 
   RowBox[{"-", "5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gives", " ", "the", " ", 
    RowBox[{"Laplacian", ".", "\[IndentingNewLine]", "laplaceEquation"}]}], 
   " ", "=", " ", 
   RowBox[{
    RowBox[{"Laplacian", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", "==", " ", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conditions", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\:043f\:0440\:0435\:0434\:0441\:0442\:0430\:0432\:043b\:044f\:0435\:0442\
", " ", "\:0441\:043e\:0431\:043e\:0439", " ", 
      "\:0433\:0440\:0430\:043d\:0438\:0447\:043d\:043e\:0435", " ", 
      "\:0443\:0441\:043b\:043e\:0432\:0438\:0435", " ", 
      "\:0414\:0438\:0440\:0438\:0445\:043b\:0435"}], ",", 
     RowBox[{
     "\:0437\:0430\:0434\:0430\:0432\:0430\:0435\:043c\:043e\:0435", " ", 
      "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0435\:043c", " ", 
      "beqn"}], ",", 
     RowBox[{
     "\:0443\:0434\:043e\:0432\:043b\:0435\:0442\:0432\:043e\:0440\:044f\:0435\
\:043c\:043e\:0435", " ", "\:043d\:0430", " ", 
      "\:0447\:0430\:0441\:0442\:0438", " ", 
      "\:0433\:0440\:0430\:043d\:0438\:0446\:044b", " ", 
      "\:043e\:0431\:043b\:0430\:0441\:0442\:0438"}], ",", 
     RowBox[{
     "\:0437\:0430\:0434\:0430\:043d\:043d\:043e\:0439", " ", "NDSolve", " ", 
      "\:0438", " ", "\:0441\:0432\:044f\:0437\:0430\:043d\:043d\:044b\:043c",
       " ", "\:0441", " ", "\:043d\:0435\:0439", " ", 
      "\:0444\:0443\:043d\:043a\:0446\:0438\:044f\:043c"}], ",", 
     RowBox[{
     "\:0433\:0434\:0435", " ", "pred", " ", "\:0438\:043c\:0435\:0435\:0442",
       " ", "\:0437\:043d\:0430\:0447\:0435\:043d\:0438\:0435", " ", 
      RowBox[{"True", ".", "\[IndentingNewLine]", 
       RowBox[{"DirichletCondition", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y"}], "]"}], "==", " ", "\[Phi]External"}], ",",
          " ", "equationExternalElectrode"}], " ", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "==", " ", "\[Phi]1"}], ",", 
       "equationElectode1"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"DirichletCondition", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "==", " ", "\[Phi]2"}], " ", ",", 
       "equationElectode2"}], " ", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "\:043d\:0430\:0445\:043e\:0434\:0438\:0442", " ", 
   "\:0447\:0438\:0441\:043b\:0435\:043d\:043d\:043e\:0435", " ", 
   "\:0440\:0435\:0448\:0435\:043d\:0438\:0435", " ", 
   "\:043e\:0431\:044b\:043a\:043d\:043e\:0432\:0435\:043d\:043d\:044b\:0445",
    " ", "\:0434\:0438\:0444\:0444\:0435\:0440\:0435\:043d\:0446\:0438\:0430\
\:043b\:044c\:043d\:044b\:0445", " ", 
   "\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439", " ", "eqns", " ",
    "\:0434\:043b\:044f", " ", "\:0444\:0443\:043d\:043a\:0446\:0438\:0438", 
   " ", "u", " ", "\:0441", " ", 
   "\:043d\:0435\:0437\:0430\:0432\:0438\:0441\:0438\:043c\:043e\:0439", " ", 
   "\:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:043e\:0439", " ", "x", 
   " ", "\:0432", " ", 
   "\:0434\:0438\:0430\:043f\:0430\:0437\:043e\:043d\:0435", " ", 
   "x\:041c\:0438\:043d", " ", "\:041a\:043e\:043c\:0443", " ", 
   RowBox[{
   "x", ".", "max", ".", "\[IndentingNewLine]", 
    "\:0438\:043d\:0442\:0435\:0440\:043f\:043e\:043b\:044f\:0446\:0438\:044f\
"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numericalSolution", " ", "=", " ", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"laplaceEquation", ",", " ", "conditions"}], "}"}], ",", " ", 
     "u", ",", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], " ", "\[Element]", " ", "fullArea"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plotWithEquipotentials", " ", "=", " ", 
  RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "\:043f\:043e\:0434\:0441\:0442\:0430\:043d\:043e\:0432\:043a\:0430", 
      "\[IndentingNewLine]", 
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], "/.", " ", 
     RowBox[{"First", "[", "numericalSolution", " ", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "fullArea"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Contours", "->", "30"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ColorFunction", "->", "\"\<TemperatureMap\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotLegends", "->", "Automatic"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]Equipotential", " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotWithFindEquipotential", " ", "=", " ", 
   RowBox[{"ContourPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "/.", " ", "numericalSolution"}], 
       " ", "]"}], "==", "\[Phi]Equipotential"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "fullArea"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Contours", "->", 
      RowBox[{"{", "\[Phi]Equipotential", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotLegends", "->", "Automatic"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ContourStyle", "->", "Green"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"plotWithEquipotentials", ",", "plotWithFindEquipotential"}], " ", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cases", " ", "-", " ", 
   RowBox[{
   "\:0441\:043e\:043e\:0442\:0432\:0435\:0442\:0441\:0432\:0438\:0435", " ", 
    "\:0448\:0430\:0431\:043b\:043e\:043d\:0443"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Normal", "@", "plotWithFindEquipotential"}], ",", 
     RowBox[{
      RowBox[{"Line", "[", "points_", "]"}], ":>", "points"}], ",", 
     "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "\:0421\:0433\:043b\:0430\:0436\:0438\:0432\:0430\:0435\:0442", " ", 
   "\:0432\:043b\:043e\:0436\:0435\:043d\:043d\:044b\:0435", " ", 
   RowBox[{
   "\:0441\:043f\:0438\:0441\:043a\:0438", ".", "\[IndentingNewLine]", 
    "\"\<\:0440\:0430\:0441\:043f\:0443\:0442\:044b\:0432\:0430\:0435\:0442\>\
\""}], " ", "\:0441\:043f\:0438\:0441\:043a\:0438"}], ",", 
  RowBox[{
  "\:0444\:0430\:043a\:0442\:0438\:0447\:0435\:0441\:043a\:0438", " ", 
   "\:043f\:0440\:043e\:0441\:0442\:043e", " ", 
   "\:0443\:0434\:0430\:043b\:044f\:044f", " ", 
   "\:0432\:043d\:0443\:0442\:0440\:0435\:043d\:043d\:0438\:0435", " ", 
   "\:0444\:0438\:0433\:0443\:0440\:043d\:044b\:0435", " ", 
   "\:0441\:043a\:043e\:0431\:043a\:0438"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "\:044d\:0444\:0444\:0435\:043a\:0442\:0438\:0432\:043d\:043e", " ", 
    "\:0441\:0433\:043b\:0430\:0436\:0438\:0432\:0430\:0435\:0442", " ", 
    "\:0432\:0435\:0440\:0445\:043d\:0438\:0439", " ", 
    "\:0443\:0440\:043e\:0432\:0435\:043d\:044c", " ", "\:0432", " ", 
    "\:0441\:043f\:0438\:0441\:043a\:0435", " ", "n", " ", 
    RowBox[{
    "\:0440\:0430\:0437", ".", "\[IndentingNewLine]", "pointsPairs"}]}], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"points", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equipotentialsLength", "=", " ", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"index", "=", "1"}], ",", 
    RowBox[{"index", "<=", 
     RowBox[{
      RowBox[{"Length", "[", "pointsPairs", "]"}], "-", "1"}]}], ",", 
    RowBox[{"index", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"equipotentialsLength", "+=", " ", 
     RowBox[{"EuclideanDistance", "[", 
      RowBox[{
       RowBox[{"pointsPairs", "[", 
        RowBox[{"[", "index", "]"}], "]"}], ",", " ", 
       RowBox[{"pointsPairs", "[", 
        RowBox[{"[", 
         RowBox[{"index", "+", "1"}], "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Text", "[", 
  RowBox[{
  "\:0414\:043b\:0438\:043d\:0430", " ", 
   "\:0438\:0441\:043a\:043e\:043c\:043e\:0439", " ", 
   "\:044d\:043a\:0432\:043f\:0438\:0442\:043e\:043d\:0435\:0446\:0438\:0430\
\:043b\:0438"}], 
  "]"}], "\[IndentingNewLine]", "equipotentialsLength"}], "Input",
 CellChangeTimes->{{3.907670593091323*^9, 3.907670606215937*^9}, {
   3.907670718592388*^9, 3.907670821195033*^9}, {3.9076710800134873`*^9, 
   3.907671393600809*^9}, 3.9076718912866735`*^9, 3.9076720493494196`*^9, 
   3.9076721133068466`*^9, {3.9076727370569954`*^9, 3.907672798013457*^9}, {
   3.907672956119035*^9, 3.907672960484664*^9}, {3.90767299512208*^9, 
   3.907673035636515*^9}, 3.907673070966552*^9, {3.907673235635871*^9, 
   3.9076733219271364`*^9}, {3.9076734685425253`*^9, 3.907673469811249*^9}, {
   3.9076735383416243`*^9, 3.9076736058332415`*^9}, {3.907673769093582*^9, 
   3.9076738220727696`*^9}, {3.907673995913253*^9, 3.9076740425624013`*^9}, {
   3.907674078132942*^9, 3.9076740908060536`*^9}, {3.907674263258311*^9, 
   3.907674301483922*^9}, {3.907675565699519*^9, 3.907675578735175*^9}, {
   3.90767565103109*^9, 3.90767569185686*^9}, 3.9078590386709895`*^9, {
   3.9078590951624947`*^9, 3.907859210637559*^9}, {3.907859405540284*^9, 
   3.907859471916505*^9}, {3.907859549341196*^9, 3.907859646256064*^9}, {
   3.9078597893956633`*^9, 3.907859791194759*^9}, {3.9078598524822283`*^9, 
   3.907860154988733*^9}, {3.9078601860500083`*^9, 3.9078602912800674`*^9}, {
   3.9078603318443384`*^9, 3.9078603499568253`*^9}, {3.9078603927692604`*^9, 
   3.9078604060686364`*^9}, {3.9078604763357167`*^9, 3.907860493182476*^9}, {
   3.907860523719533*^9, 3.9078605886238565`*^9}, {3.907860630009426*^9, 
   3.907860657684963*^9}, {3.9078606883755274`*^9, 3.9078608065757694`*^9}, {
   3.9078609802086244`*^9, 3.9078609880418997`*^9}, {3.9078610318157997`*^9, 
   3.907861032443495*^9}, {3.9078611541296034`*^9, 3.9078611546178102`*^9}, {
   3.9078612178154664`*^9, 3.907861434291335*^9}, 3.9078614807858505`*^9, {
   3.9078615217060823`*^9, 3.90786152456658*^9}, 3.9078615600426607`*^9, {
   3.9078617444954987`*^9, 3.907861750738473*^9}, {3.9078618607642336`*^9, 
   3.907861878053461*^9}, {3.9078655721056995`*^9, 3.9078656903566084`*^9}, {
   3.907865730734347*^9, 3.9078658284906406`*^9}, {3.9078668953143063`*^9, 
   3.9078668988012376`*^9}, {3.907867218020835*^9, 3.907867218930453*^9}, {
   3.9078684677279615`*^9, 3.9078684685463085`*^9}, {3.909041374988845*^9, 
   3.9090413753194337`*^9}, {3.9090414071662407`*^9, 3.909041407657648*^9}, {
   3.909041439830204*^9, 3.909041440275669*^9}, 3.9090414722428102`*^9, {
   3.9090415109568377`*^9, 3.909041551584941*^9}, {3.9090415943726516`*^9, 
   3.909041603711171*^9}, {3.909041654237921*^9, 
   3.909041684542703*^9}},ExpressionUUID->"c57122f0-cd3a-4e4a-a952-\
1e3b506e622e"]
},
WindowSize->{1440., 741.75},
WindowMargins->{{1146, Automatic}, {Automatic, -6}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.4 Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4f556fff-3e09-4201-abcb-d5b2d7330958"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 15215, 350, 2338, "Input",ExpressionUUID->"c57122f0-cd3a-4e4a-a952-1e3b506e622e"]
}
]
*)

