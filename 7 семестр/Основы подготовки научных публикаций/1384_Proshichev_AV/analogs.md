# Сравнение аналогов

## Принцип отбора аналогов

В ходе поиска аналогов было принято решение опираться на работы, в которых используется датасет WESAD. Данный датасет представляет собой набор биомедицинских измерений с запястия и груди, размеченный по эмоциональному состоянию человека на основе психологического тестирования. Кроме того, важным аспектом исследования являются модели глубинного обучения с рекурентной архитектурой, то есть рекурентные нейронные сети (далее - RNN), а именно архитектура Long short-term memory (далее - LSTM). Таким образом, запрос включал в себя такие ключевые слова, как stress/stress detection/stress recognition, RNN/LSTM и WESAD. Рассматриваемые статьи были найдены посредством поисковой системы Google Academy.

### Статья "Systematic Evaluation of Personalized Deep Learning Models for Affect Recognition"

Данная работа [1] направлена на исследование моделей глубинного обучения для распознавания аффективных состояний у человека на основе пяти открытых датасетов. Одним из рассматриваемых состояний являлся стресс, детектирование которого происходило на основе обучения на датасете WESAD. Авторы выбрали измерения как с запястия, так и груди. Предобработка данных происходила в несколько этапов: удаление шумов посредством отбрасывания значений вне диапазона квантилей 0.03 и 0.97, применение фильтра Butterworth для подавления частот свыше 10 Гц, минмаксная нормализация данных и разбиение сигнала на последовательность окон размером в 10 секудн и наложением друг на друга в 50%. В статье были выбраны три модели для глубокого обучения с архитектурами full-connected network (далее - FCD), Multi-Layer Perceptron с LSTM (далее - MLP-LSTM) и Residual Network (далее - ResNet). Для валидации модели использовались такие методы, как K-fold и Leave-One-Population-Out. В роли метрик оценки точности модели используются Accuracy, F1-score и AUROC. Точность MLP-LSTM оказалось самой высокой среди рассматриваемых моделей и составила значение метрик Accuracy, F1-score и AUROC 0.922, 0.890 и 0.922 соответственно.

### Статья "An improved approach for stress detection using physiological signals"

Данная работа [2] направлена на разработку LSTM-модели для решения задачи бинарной классифицации детектирования стресса у человека. Исследование производится на датасете WESAD. В роли ключевых измерений используются измерения только с груди. Была проведена селекция признаков с помощью модели Extra Tree Classifier, позволяющей оценить корреляцию каждого отдельного признака с результатом. Была проведена генерация дополнительных признаков на основе статистических функций (min, max, mean, std) для временных рядов с различной длиной плавающего окна подсчёта. Рассматривалось три варианта подачи входных данных:
- Случаные 80% измерений для обучения и оставшиеся 20% для валидации
- Данные 14 субъектов для обучения и данные оставшихся субъектов для валидации
- Данные 13 субъектов для обученяи и данные оставшихся субъектов для валидации

В роли метрик оценки точности модели используются Accuracy и Recall. Самую высокую точность показал первый и третий вариант подачи данных со значениями Accuracy и Recall 0.98 и 0.99, 0.98 и 0.98 соответсвенно.

### Статья "High-resolution physiological stress prediction models based on ensemble learning and recurrent neural networks"

Данная работа [3] направлена на разработку регрессионных и многоклассовых моделей, способных оценивать уровень стресса у человека. Исследование производится на датасете WESAD. В качестве ключевых измерений использовались такие измерения, как ECG и EDA. Была проведена генерация дополнительных признаков HRV, RR и HR на основе ECG. Для вычисления уровня стресса использовались психологические тесты PANAS и STAI, приложенные к датасету. На основе ответов испытуемых высчитывали SS (stress score) и использовали, как целевые значения для измерений. В качестве моделей использовали ансамбли и RNN, а именно LSTM  и Nonlinear AutoRegressive network with eXogenous inputs (далее - NARX). К моделям была применена валидация K-fold с помощью методов подбора гиперпараметров GridSearch. В роли метрик оценки точности модели используются MSE, MAE, R^2, 3-class accuracy и 4-class accuracy. По результатам NARX показала самые высокие результаты, а LSTM - самые низкие среди рассматриваемых моделей.

### Статья "Scalable deep learning for stress and affect detection on resource-constrained devices"

Данная работа [4] направлена на изучение масштабируемости моделей бинарной классификации в целях их использования на портативных устройствах. Исследование производится на трёх датасетах: WESAD, SWELL-KW, DREAMER. В роли ключевых измерений используются измерения только с запястия. Каждый датасет хранит в себе различные наборы биомедицинских измерений. Была проведена предобработка данных на основе метода Multiple Instance Learning (далее - MIL), позволяющего с помощью плавающего окна выделить более точно участники сигнала, которые соответствуют состоянию стресса у человека, и выделить шумы, которые сигнатурой класса не являются, но имеют данную метку. В качестве моделей используются RNN, а именно LSTM, Gated Recurrent Unit (далее - GRU) и Fast, Accurate, Stable and Tiny Kilobyte Sized Gated Recurrent Neural Network (далее - FastGRNN). В роли метрики оценки точности моделей используются Accuracy. Среди рассматриваемых моделей на датасете WESAD LSTM отработала точнее модели GRU, но менее точно, чем FastGRNN. Точность Accuracy для модели LSTM на датасете WESAD составила 93.09%.

### Статья "Stress Classification using ECGs based on a Multi-dimensional Feature Fusion of LSTM and Xception"

Данная работа [5] была нацелена на создание модели бинарной классификации детектирования стресса только на основе ЭКГ-сигнала. Исследование проводится на датасете WESAD. Авторы разработали классификатор, комбинирующий в себе две модели машнного обучения: рекуррентную нейронную сеть LSTM и свёрточную нейронную сеть Xception. Данные прошли предобработку и фильтрацию на шум с помощью определения R-пиков ЭКГ-сигнала и последующей обработки интвералов между ними. Авторы также провели генерацию новых признаков, так для модели LSTM были выделены 9 признаков из ЭКГ, одна часть из которых является временными и была произведена на основе признака HVR, а другая - является частотными и была произведена с помощью пропускных фильтров, нацеленных на низкие и высокие частоты. В роли метрики оценки точности моделей выступила Accuracy. Модель LSTM показалад самый высокий результат на очищенных от шума данных при длине окна в 5 секунд, в рамках которого вычислялись временным признаки, - 81.42%.

## Критерии сравнения аналогов
Для упрощения анализа будет производиться сравнение моделей с архитектурой LSTM на датасете WESAD.

### Биомедицинские измерения

Данный критерий показывает, какие биомедицинские измерения выбирались авторами для обучения своих моделей. Важность критерия обуславливается тем, что данные играют первоначальную роль в постронии корреляционных связей. Критерий позволит оценить информативность биомедицинских измерений.

### Входные данные модели

Распространённым методом обработки биомедицинских сигналов для сэмплирования данных и генерации признаков в датасете является скользящее окно [6, 7]. Сэмплирование данным методом заключается в разбиении временного ряда на интервалы фиксированной длины, которые могут перекрываться друг с другом. Генерация признаков же заключается в получении отдельных временных и частотных признаков, характеризующий часть сигнала в конкретном интервале. В рассматриваемых статьях используются разные статистики и подходы для их генерации. Критерий позволяет сравнить подходы к генерации данных, на основе которых модель проходит этап обучения и валидации.

### Метрика качества Accuracy

Основным способом оценки качества моделей машинного обучения является использование метрик качества. Данный критерий играет ключевую роль, так как любые изменения в одном или нескольких этапах пайплайна модели оцениваются посредством тенденции изменения значений выходных метрик. В качестве основной метрики оценки качества модели в задаче детекции стресса была выбрана метрика Accuracy.
 
## Таблица сравнения аналогов

| Авторы статьи | Биомедицинские измерения | Входные данные модели | Метрика качества Accuracy |
|-------|----------------------------|--------------------------------------------------|--------------------------------------|
| Han Y. | ECG - Электрокардиограмма <br> EDA - Электродермальная активность <br> EMG - Электромиография <br> BVP - Пульс объема крови <br> TEMP - Температура тела <br> RESP - Частота дыхания <br> ACC - Трёхосный акселерометр | Только симплирование | Accuracy - 92.2% |
| Nigam K. | EDA - Электродермальная активность  <br> TEMP - Температура тела <br> ACC - Трёхосный акселерометр | Сэмплирование и генерация подсчётом частотных признаков <br><br> 1. Частотные признаки для ACC: <br>  $maxX$ - максимальное значение по оси X <br> $maxY$ - максимальное значение по оси Y <br> $maxZ$ - максимальное значение по оси Z  <br> $mean = \frac{\bar{X} + \bar{Y} + \bar{Z}}{3}$ <br> $std$ - среднеквадративное отклонение <br><br> 2. Частотные признаки для TEMP и EDA: <br> $max$ - максимальное значение <br> $min$ - минимальное значение <br> $mean$ - среднее значение <br> $range = max - min$ <br> $std$ - среднеквадративное отклонение | Accuracy - 98% |
| Di Martino F., Delmastro F. | HRV - Вариабельность сердечного ритма <br> EDA - Электродермальная активность <br> ECG - Электрокардиограмма | Сэмплирование и генерация подсчётом временных и частотных признаков. EDA разделяется на кожную проводимость реакции (далее - SCR) и кожную проводимость уровня (далее - SCL).<br><br> 1. Временные признаки для ECG: <br> Вычисление RR-интеравлов, составляющих расстояние между R-пиками <br> Вычисление HR (частота сердечных сокращений) $HR(bpm) = \frac{60}{RR(s)} $ <br><br> 2. Частотные признаки для SCR: <br> $mean$ - среднее значение <br> $max$ - максимальное значение | 3-class Accuracy - 60% <br> 4-class Accuracy - 70% |
| Ragav A. | ECG - Электрокардиограмма <br> EDA - Электродермальная активность <br> EMG - Электромиография <br> RESP - Частота дыхания <br> TEMP - Температура тела <br> ACC - Трёхосный акселерометр  | Только симплирование  | Accuracy - 93.09% |
| Song C. H. | ECG - Электрокардиограмма | Сэмплирование и генерация подсчётом временных и частотных признаков. Для вычисления временных признаков были подсчитаны RR-интервалы, состовляющие расстояние между R-пиками <br> <br><br> 1. Временные признаки для ECG: <br> $ mRR = \frac{\sum_{i=1}^N RR_i}{N} $ - среднее значение RR-интвералов <br> $ mHR = \frac{\sum_{i=1}^{N} (60000/RR_i)}{N} - среднее значение частоты сердечных сокращений $ <br> $ RMSSD = \sqrt{\frac{1}{N - 1} \sum_{i=1}^{N-1} (RR_{i+1} - RR_i)^2 } $ - среднеквадратичное отклонение RR-интервалов <br><br> 2. Частотные признаки для ECG: <br> $HF$ [$мс^2$] - мощность в высокочастотной полосе (0.15 - 0.4 Гц) <br> $LF$ [$мс^2$] - мощность в низкочастотной полосе (0.04 - 0.15 Гц) <br> $VLF$ [$мс^2$] - мощность в более низкочастотной полосе ($\le$ 0.04) <br> $nHF = \left( \frac{HF}{TotalPower - VLF} \right) \cdot 100$ [%] - нормализованная мощность в высокочастотной полосе <br> $dLFHF = LF - HF$ [$мс^2$] - разница мощностей между низкочастотной и высокочастотной полосами <br> $SVI = \frac{LF}{HF}$ - индекс симпато-вагального баланса | Accuracy - 81.42% |

## Выводы по итогам сравнения

В ходе обзора аналогов можно заключить, что такие биомедицинские измерения, как ECG, EDA, HRV, TEMP и  ACC, выбирались авторами рассмотренных статей чаще всего из датасета WESAD. Как показывает значение точности модели автора Song C.H., обучение на данных, выделенных только из электрокардиограммы, позволяет получить метрика качества Accuracy порядка 80%. Также в каждой работе был применён метод скользящего окна для сэмплирования данных и вычисления дополнительных временных и частотных признаков. Обзор демонстрирует, что результат работы моделей имеет точность 80-98%, которой авторы добивались как использованием большого количества биомедицинских измерений с использованием одного лишь сэмплирования в скользящем окне, так и использованием небольшой выборки биомедицинских измерений с генерацией большого количества дополнительных временных или частотных признаков после сэмплирования в скользящем окне. Однако, наивысшая точностью была достигнута в работах с наличием генерации временных и частотных признаков. В работах, которые использовали скользящее окно только для сэмплирования, выбирались сигналы EMG и RESP. Частыми подходами среди работ, генерирующих новые признаки, являлись генерация RR-интевралов и последующее вычисление частоты сердечных сокращений на основе сигнала ECG, а также вычисление таких статистик для сигнала EDA, как максимальное и минимальное значения, среднее значение, среднее стандартное отклонение и длина диапазона значений. 

## Выбор метода решения

По результатам обзора можно предложить следующую схему подготовки данных для обучения модели. Данные выбираются из датасета WESAD. Используются сигналы как с датчиков на запястии, так и с датчиков на груди. Используется скользящее окно для сэмплирования и генерации новых частотных и временных признаков. Для сэмплирования выбраны такие биомедицинские сигналы, как ECG, EDA, HRV, TEMP, ACС, EMG и RESP. Генерация происходит на основе ECG и EDA сигналов. Для сигнала ECG вычисляются частотные признаки: mRR, mHR и RMSSD - а также временные признаки: HF, LF, VLF, nHF, dLFHF и SVI. Для сигнала EDA вычисляются частотные признаки: минимальное значение, максимальное значение, среднее значение, среднеквадративное отклонение и длина диапазона значений. 

## Список использованных источников

1. Han Y. et al. Systematic Evaluation of Personalized Deep Learning Models for Affect Recognition //Proceedings of the ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies. – 2024. – Т. 8. – №. 4. – С. 1-35.
2. Nigam K. et al. An improved approach for stress detection using physiological signals //EAI Endorsed Transactions on Scalable Information Systems. – 2021. – Т. 8. – №. 33.
3. Di Martino F., Delmastro F. High-resolution physiological stress prediction models based on ensemble learning and recurrent neural networks //2020 IEEE symposium on computers and communications (ISCC). – IEEE, 2020. – С. 1-6.
4. Ragav A. et al. Scalable deep learning for stress and affect detection on resource-constrained devices //2019 18th IEEE International Conference On Machine Learning And Applications (ICMLA). – IEEE, 2019. – С. 1585-1592.
5. Song C. H. et al. Stress Classification using ECGs based on a Multi-dimensional Feature Fusion of LSTM and Xception //IEEE Access. – 2024.
6. Mishra V. et al. Evaluating the reproducibility of physiological stress detection models //Proceedings of the ACM on interactive, mobile, wearable and ubiquitous technologies. – 2020. – Т. 4. – №. 4. – С. 1-29.
7. Shu L. et al. A review of emotion recognition using physiological signals //Sensors. – 2018. – Т. 18. – №. 7. – С. 2074.